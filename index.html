<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>奇跡が起きた未来の一日を描く — 20の問い</title>
  <meta name="description" content="20の問いに答えると、AIが一人称の『奇跡の未来日記』を自動生成します。" />
  <style>
    :root { --bg:#0b0c10; --ink:#e9f1ff; --muted:#a9b4c9; --card:#121318; --line:#222634; --accent:#7aa2ff; --accent2:#a07cff; }
    * { box-sizing: border-box; } body { margin:0; background:var(--bg); color:var(--ink); font:16px/1.65 system-ui,sans-serif; }
    .wrap { max-width:960px; margin:0 auto; padding:24px; } h1{margin:0 0 8px; font-size:clamp(22px,4.4vw,34px); line-height:1.2;}
    .sub{color:var(--muted); margin:0 0 18px;} .card{background:rgba(255,255,255,.05); border:1px solid var(--line); border-radius:14px; padding:18px;}
    label{display:block; margin-top:12px;} input[type=text]{width:100%; padding:12px; border-radius:10px; border:1px solid var(--line); background:var(--card); color:var(--ink);}
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px;} button{border:none; border-radius:12px; padding:12px 16px; font-weight:700; cursor:pointer;}
    .primary{background:linear-gradient(135deg,var(--accent),var(--accent2)); color:#0b0c10;} .ghost{background:transparent; border:1px solid var(--line); color:var(--ink);}
    .out{white-space:pre-wrap; background:var(--card); border:1px solid var(--line); border-radius:12px; padding:14px; margin-top:14px; min-height:120px;}
    .note{color:var(--muted); font-size:13px;}
  </style>
</head>
<body>
  <main class="wrap">
    <h1>奇跡が起きた未来の一日を描く — 20の問い</h1>
    <p class="sub">直感で埋めて「AIで小説生成」を押すと、あなたの未来の一日が<strong>小説風</strong>に現れます。</p>
    <section class="card">
      <form id="form20">
        <label>1) 目を開けたとき、どこ？どんな光景？<br><input id="q1" type="text" placeholder="例：海辺の別荘の大きな窓。朝日が波に砕ける。"></label>
        <label>2) 朝の空気の温度・香りは？<br><input id="q2" type="text" placeholder="例：ひんやり、コーヒーと潮の香り。"></label>
        <label>3) 寝具の感触は？<br><input id="q3" type="text" placeholder="例：リネンの軽さ、体温のぬくもり。"></label>
        <label>4) 一緒にいる人は？どんな表情？<br><input id="q4" type="text" placeholder="例：パートナー、安堵の笑み。"></label>
        <label>5) 「今日は特別」と感じる理由は？<br><input id="q5" type="text" placeholder="例：出版と新事業のローンチ。"></label>
        <label>6) 窓の外の景色・音は？<br><input id="q6" type="text" placeholder="例：群青の海、遠くの汽笛。"></label>
        <label>7) 身支度・服装・姿勢は？<br><input id="q7" type="text" placeholder="例：白のシャツドレス、背筋はまっすぐ。"></label>
        <label>8) 朝食の香りと味、誰と何を話す？<br><input id="q8" type="text" placeholder="例：ハニーの香り、編集者と作戦会議。"></label>
        <label>9) 玄関を出るときの心のエネルギーは？<br><input id="q9" type="text" placeholder="例：透明で強い推進力。"></label>
        <label>10) 道中で感じたサインや偶然は？<br><input id="q10" type="text" placeholder="例：777のナンバー、風が急にやむ。"></label>
        <label>11) 大きな出来事の舞台は？<br><input id="q11" type="text" placeholder="例：ガラス張りの会場・舞台袖。"></label>
        <label>12) 奇跡の瞬間、周囲の表情や声は？<br><input id="q12" type="text" placeholder="例：一拍の静寂、やがて歓声。"></label>
        <label>13) あなたの感情と体の反応は？<br><input id="q13" type="text" placeholder="例：胸が熱く、呼吸が深く、視界がクリア。"></label>
        <label>14) 何が「叶った」と確信した？<br><input id="q14" type="text" placeholder="例：世界線自販機™ 初日完売。"></label>
        <label>15) それを誰と分かち合い、どんな言葉を？<br><input id="q15" type="text" placeholder="例：チームと抱擁、『やったね』。"></label>
        <label>16) 夕方の空と風の変化は？<br><input id="q16" type="text" placeholder="例：茜から群青、風は穏やか。"></label>
        <label>17) 夜の席で今日をどう語る？<br><input id="q17" type="text" placeholder="例：『予定調和じゃない、必然だった』。"></label>
        <label>18) 感謝や喜びは体のどこに？<br><input id="q18" type="text" placeholder="例：みぞおちの奥が温かい。"></label>
        <label>19) 眠る前、未来の自分は何とつぶやく？<br><input id="q19" type="text" placeholder="例：ここからは軽やかに増幅する。"></label>
        <label>20) 明日からの人生はどう変わる？<br><input id="q20" type="text" placeholder="例：創作と経営がひとつに結び、周囲も豊かに。"></label>
        <div class="row">
          <button type="submit" class="primary">AIで小説生成（β）</button>
          <button type="button" class="ghost" id="clearBtn">クリア</button>
          <span class="note">※ 送信後、数秒〜20秒ほどかかります。</span>
        </div>
      </form>
      <div id="out" class="out" hidden></div>
    </section>
  </main>
  <script>
    const form = document.getElementById('form20');
    const out = document.getElementById('out');
    const clearBtn = document.getElementById('clearBtn');
    function val(id){ return (document.getElementById(id)?.value || '').trim(); }
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const answers = Array.from({length:20}, (_,i)=> val('q'+(i+1)));
      out.hidden = false; out.textContent = "AIが物語を生成中…（10〜20秒）";
      try{
        const r = await fetch('/api/generate-story', {
          method: 'POST', headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ answers, total: 20 })
        });
        const { story, error } = await r.json();
        if (error) throw new Error(typeof error==='string'?error:JSON.stringify(error));
        out.textContent = story || "生成できませんでした。入力を見直して再実行してください。";
      }catch(err){ console.error(err); out.textContent = "通信エラー：少し待って再実行してください。"; }
    });
    clearBtn.addEventListener('click', ()=>{
      for (let i=1;i<=20;i++){ const el = document.getElementById('q'+i); if (el) el.value = ''; }
      out.hidden = true; out.textContent = '';
    });
  </script>
</body>
</html>
